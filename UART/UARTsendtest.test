<!DOCTYPE Robei>
<Module Color="#f5f5dc" Y="0" Width="1024" File="Current/UARTsendtest.test" Comment="" Time_Scale="" Type="testbench" Class="module" Name="UARTsendtest" Code="initial begin&#xa;clk16x=0;&#xa;rst_n=1;&#xa;TransEn=0;&#xa;DataToTrans=0;&#xa;#2&#xa;rst_n=0;&#xa;#2&#xa;DataToTrans=8'b10110010;&#xa;#2&#xa;rst_n=1;&#xa;#2&#xa;TransEn=1;&#xa;&#xa;&#xa;#1000&#xa;$finish;&#xa;end&#xa;&#xa;&#xa;always begin&#xa;#1&#xa;clk16x=~clk16x;&#xa;end&#xa;&#xa;&#xa;&#xa;" Height="720" X="0" Parent="0">
 <Module Color="#f5f5dc" Y="187.5" Width="402" File="Current/UARTsend.model" Comment="" Type="model" Class="UARTsend" Name="UARTsend1" Code="&#xa;/*    capture the rising edge of TransEn    */&#xa;reg [7:0] cnt; &#xa;reg TransEn_r;&#xa;wire pos_tri;&#xa;always@(posedge clk16x or negedge rst_n)&#xa;begin&#xa;    if(!rst_n)&#xa;        TransEn_r &lt;= 1'b0;&#xa;    else&#xa;        TransEn_r &lt;= TransEn;&#xa;end&#xa;assign pos_tri = ~TransEn_r &amp; TransEn;&#xa;&#xa;/*&#xa;*    when the rising edge of DataEn comes up, load the Data to buffer&#xa;*/&#xa;reg [7:0] ShiftReg;&#xa;always@(posedge pos_tri or negedge rst_n)&#xa;begin&#xa;    if(!rst_n)&#xa;        ShiftReg &lt;= 8'b0;&#xa;    else&#xa;        ShiftReg &lt;= DataToTrans;&#xa;end&#xa;//----------------------------------------------    &#xa;/*     counter control      */&#xa;reg cnt_en;&#xa;always@(posedge clk16x or negedge rst_n)&#xa;begin&#xa;    if(!rst_n)&#xa;        begin&#xa;            cnt_en  &lt;= 1'b0;&#xa;            BufFull &lt;= 1'b0;&#xa;        end&#xa;    else if(pos_tri==1'b1)&#xa;        begin&#xa;            cnt_en  &lt;=1'b1;&#xa;            BufFull &lt;=1'b1;&#xa;        end&#xa;    else if(cnt==8'd160)&#xa;        begin&#xa;            cnt_en&lt;=1'b0;&#xa;            BufFull &lt;=1'b0;&#xa;        end&#xa;end&#xa;&#xa;//---------------------------------------------&#xa;/*      counter module        */&#xa;&#xa;always@(posedge clk16x or negedge rst_n)&#xa;begin&#xa;    if(!rst_n)&#xa;        cnt&lt;=8'd0;&#xa;    else if(cnt_en)&#xa;        cnt&lt;=cnt+1;&#xa;    else&#xa;        cnt&lt;=8'd0;&#xa;end&#xa;&#xa;//---------------------------------------------&#xa;/*      transmit module        */&#xa;&#xa;always@(posedge clk16x or negedge rst_n)&#xa;begin&#xa;    if(!rst_n)&#xa;        begin&#xa;            tx &lt;= 1'b1;&#xa;        end&#xa;    else if(cnt_en)&#xa;        case(cnt)&#xa;            8'd0   :  tx &lt;= 1'b0;&#xa;            8'd16  :  tx &lt;= ShiftReg[0];&#xa;            8'd32  :  tx &lt;= ShiftReg[1];&#xa;            8'd48  :  tx &lt;= ShiftReg[2];&#xa;            8'd64  :  tx &lt;= ShiftReg[3];&#xa;            8'd80  :  tx &lt;= ShiftReg[4];&#xa;            8'd96  :  tx &lt;= ShiftReg[5];&#xa;            8'd112 :  tx &lt;= ShiftReg[6];&#xa;            8'd128 :  tx &lt;= ShiftReg[7];&#xa;            8'd144 :  tx &lt;= 1'b1;&#xa;        endcase&#xa;    else&#xa;        tx &lt;= 1'b1;&#xa;end&#xa;&#xa;&#xa;&#xa;&#xa;" Height="361" Parameters="" X="293.222" Parent="UARTsendtest">
  <Port Color="#faebd7" Y="0.144044" Width="20" Name="clk16x" Inout="input" Side="left" Height="20" Function="transmit clock,16Ã—115200" Datasize="1" Datatype="wire" X="-0.0497512" Parent="UARTsend1"/>
  <Port Color="#00ffff" Y="0.310249" Width="20" Name="rst_n" Inout="input" Side="left" Height="20" Function="global reset signal " Datasize="1" Datatype="wire" X="-0.0497512" Parent="UARTsend1"/>
  <Port Color="#7fffd4" Y="0.476454" Width="20" Name="TransEn" Inout="input" Side="left" Height="20" Function=" transmit enable   " Datasize="1" Datatype="wire" X="-0.0497512" Parent="UARTsend1"/>
  <Port Color="#f0ffff" Y="0.642659" Width="20" Name="DataToTrans" Inout="input" Side="left" Height="20" Function="Data prepared for transmitting" Datasize="8" Datatype="wire" X="-0.0497512" Parent="UARTsend1"/>
  <Port Color="#cd853f" Y="0.227147" Width="20" Name="BufFull" Inout="output" Side="right" Height="20" Function="Data buffer is full" Datasize="1" Datatype="reg" X="0.950249" Parent="UARTsend1"/>
  <Port Color="#ffe4c4" Y="0.476454" Width="20" Name="tx" Inout="output" Side="right" Height="20" Function="serial data out " Datasize="1" Datatype="reg" X="0.950249" Parent="UARTsend1"/>
 </Module>
 <Port Color="#faebd7" Y="0.169444" Width="20" Name="clk16x" Inout="input" Side="left" Height="20" Function="transmit clock,16*115200" Datasize="1" Datatype="reg" X="-0.0244141" Parent="UARTsendtest"/>
 <Port Color="#00ffff" Y="0.313889" Width="20" Name="rst_n" Inout="input" Side="left" Height="20" Function="global reset signal" Datasize="1" Datatype="reg" X="-0.0195313" Parent="UARTsendtest"/>
 <Port Color="#7fffd4" Y="0.484722" Width="20" Name="TransEn" Inout="input" Side="left" Height="20" Function="transmit enable" Datasize="1" Datatype="reg" X="-0.0195313" Parent="UARTsendtest"/>
 <Port Color="#f0ffff" Y="0.643056" Width="20" Name="DataToTrans" Inout="input" Side="left" Height="20" Function="Data prepared for transmitting" Datasize="8" Datatype="reg" X="-0.0195313" Parent="UARTsendtest"/>
 <Port Color="#cd853f" Y="0.238889" Width="20" Name="BufFull" Inout="output" Side="right" Height="20" Function="Data buffer is full" Datasize="1" Datatype="wire" X="0.980469" Parent="UARTsendtest"/>
 <Port Color="#ffe4c4" Y="0.488889" Width="20" Name="tx" Inout="output" Side="right" Height="20" Function="serial data out" Datasize="1" Datatype="wire" X="0.980469" Parent="UARTsendtest"/>
 <Wire To="UARTsendtest#UARTsend1>clk16x" From="UARTsendtest>clk16x" Name="clk16x_clk16x" Datasize="1" Datatype="wire" Parent="UARTsendtest"/>
 <Wire To="UARTsendtest#UARTsend1>rst_n" From="UARTsendtest>rst_n" Name="rst_n_rst_n" Datasize="1" Datatype="wire" Parent="UARTsendtest"/>
 <Wire To="UARTsendtest#UARTsend1>TransEn" From="UARTsendtest>TransEn" Name="TransEn_TransEn" Datasize="1" Datatype="wire" Parent="UARTsendtest"/>
 <Wire To="UARTsendtest>tx" From="UARTsendtest#UARTsend1>tx" Name="tx_tx" Datasize="1" Datatype="wire" Parent="UARTsendtest"/>
 <Wire To="UARTsendtest>BufFull" From="UARTsendtest#UARTsend1>BufFull" Name="BufFull_BufFull" Datasize="1" Datatype="wire" Parent="UARTsendtest"/>
 <Wire To="UARTsendtest#UARTsend1>DataToTrans" From="UARTsendtest>DataToTrans" Name="DataToTrans_DataToTrans" Datasize="8" Datatype="wire" Parent="UARTsendtest"/>
</Module>
